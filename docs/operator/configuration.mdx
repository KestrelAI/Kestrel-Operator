---
title: Configuration Reference
description: Complete reference for all Kestrel Operator configuration options
---

## Helm Values Reference

The Kestrel Operator is configured through Helm values. Below is a complete reference of all available configuration options.

## Quick Configuration Examples

### Basic Cilium Setup
```yaml
auth:
  token: "your-token-here"

operator:
  cluster:
    id: "cluster-uuid"
    name: "production-cluster"
```

### Istio Service Mesh Setup
```yaml
auth:
  token: "your-token-here"

operator:
  cluster:
    id: "cluster-uuid"
    name: "production-cluster"
  cilium:
    disableFlows: true
  istio:
    enabled: true
    alsPort: 8080
```

### Safe-Apply Enabled
```yaml
auth:
  token: "your-token-here"

operator:
  cluster:
    id: "cluster-uuid"
    name: "production-cluster"
  safeApply:
    enabled: true
```

## Complete Values Reference

### Core Settings

#### `replicaCount`
- **Type**: integer
- **Default**: `1`
- **Description**: Number of operator replicas to deploy

<Warning>
  Currently, only single-replica deployments are supported. Multi-replica HA mode is coming soon.
</Warning>

### Image Configuration

#### `image.repository`
- **Type**: string
- **Default**: `ghcr.io/kestrelai/kestrel-operator`
- **Description**: Container image repository

#### `image.tag`
- **Type**: string
- **Default**: `latest`
- **Description**: Container image tag

#### `image.pullPolicy`
- **Type**: string
- **Default**: `IfNotPresent`
- **Options**: `Always`, `IfNotPresent`, `Never`
- **Description**: Image pull policy

### Authentication

#### `auth.token` (Required)
- **Type**: string
- **Default**: `""`
- **Description**: JWT token for operator authentication
- **Example**: `"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."`

<Note>
  Generate this token through the Kestrel AI Dashboard. The token automatically renews every 24 hours.
</Note>

### Server Connection

#### `server.host`
- **Type**: string
- **Default**: `grpc.platform.usekestrel.ai`
- **Description**: Kestrel AI platform gRPC endpoint

#### `server.port`
- **Type**: integer
- **Default**: `443`
- **Description**: gRPC server port

#### `server.useTLS`
- **Type**: boolean
- **Default**: `true`
- **Description**: Enable TLS for server connection

### Operator Configuration

#### `operator.cluster.id`
- **Type**: string
- **Description**: Unique cluster identifier (UUID)
- **Generated**: Automatically provided when generating token

#### `operator.cluster.name`
- **Type**: string
- **Description**: Human-readable cluster name
- **Example**: `"production-us-west"`

### Cilium Integration

#### `operator.cilium.disableFlows`
- **Type**: boolean
- **Default**: `false`
- **Description**: Disable Cilium flow collection entirely

Set to `true` when:
- Using Istio for flow collection instead
- Cluster doesn't have Cilium installed
- Only want resource inventory management

#### `operator.cilium.hubble.tls.forceDisable`
- **Type**: boolean
- **Default**: `false`
- **Description**: Force disable TLS for Hubble connections

<Info>
  By default, the operator attempts to use TLS when connecting to Hubble Relay. Only disable if your Hubble setup doesn't support TLS.
</Info>

### Istio Integration

#### `operator.istio.enabled`
- **Type**: boolean
- **Default**: `false`
- **Description**: Enable Istio Access Log Service (ALS) for L7 flow collection

#### `operator.istio.alsPort`
- **Type**: integer
- **Default**: `8080`
- **Description**: Port for the ALS gRPC server

<Note>
  When enabling Istio, ensure your Envoy proxies are configured to send access logs to the operator's ALS endpoint.
</Note>

### Safe-Apply Configuration

#### `operator.safeApply.enabled`
- **Type**: boolean
- **Default**: `false`
- **Description**: Grant RBAC permissions for applying approved YAML changes

When enabled, the operator can:
- Create network policies
- Update existing resources
- Delete resources (with approval)

### Health Check Configuration

#### `healthcheck.port`
- **Type**: integer
- **Default**: `8081`
- **Description**: Health check HTTP server port

#### `healthcheck.livenessProbe`

Configuration for Kubernetes liveness probe:

```yaml
healthcheck:
  livenessProbe:
    initialDelaySeconds: 30  # Wait before first check
    periodSeconds: 30        # Check interval
    timeoutSeconds: 5        # Timeout per check
    failureThreshold: 3      # Failures before restart
    successThreshold: 1      # Successes to be healthy
```

### Resource Limits

#### Production Settings (Default)
```yaml
resources:
  limits:
    cpu: 500m
    memory: 2Gi
  requests:
    cpu: 250m
    memory: 1Gi
```

#### Development/Testing
```yaml
resources:
  limits:
    cpu: 200m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi
```

#### High-Volume Clusters
```yaml
resources:
  limits:
    cpu: 1000m
    memory: 4Gi
  requests:
    cpu: 500m
    memory: 2Gi
```

### Pod Configuration

#### `podSecurityContext`
```yaml
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65534      # nobody user
  fsGroup: 65534
```

#### `securityContext`
```yaml
securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 65534
```

### Service Account

#### `serviceAccount.create`
- **Type**: boolean
- **Default**: `true`
- **Description**: Create a service account for the operator

#### `serviceAccount.name`
- **Type**: string
- **Default**: `""` (auto-generated)
- **Description**: Override service account name

#### `serviceAccount.annotations`
- **Type**: object
- **Default**: `{}`
- **Description**: Annotations for the service account

Example for AWS IRSA:
```yaml
serviceAccount:
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::123456789:role/kestrel-operator
```

### Network Policy

#### `networkPolicy.create`
- **Type**: boolean
- **Default**: `false`
- **Description**: Create a NetworkPolicy for the operator

When enabled, creates a policy that:
- Allows ingress from Istio (if enabled)
- Allows egress to Kestrel platform
- Allows DNS resolution

### Node Selection

#### `nodeSelector`
- **Type**: object
- **Default**: `{}`
- **Description**: Node selector for pod scheduling

Example:
```yaml
nodeSelector:
  kubernetes.io/os: linux
  node-role.kubernetes.io/worker: "true"
```

#### `tolerations`
- **Type**: array
- **Default**: `[]`
- **Description**: Tolerations for pod scheduling

Example:
```yaml
tolerations:
- key: "dedicated"
  operator: "Equal"
  value: "monitoring"
  effect: "NoSchedule"
```

#### `affinity`
- **Type**: object
- **Default**: `{}`
- **Description**: Affinity rules for pod scheduling

Example:
```yaml
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
    - weight: 100
      podAffinityTerm:
        labelSelector:
          matchLabels:
            app: kestrel-operator
        topologyKey: kubernetes.io/hostname
```

## Environment-Specific Configurations

### Development Environment
```yaml
auth:
  token: "dev-token"

resources:
  limits:
    cpu: 200m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi

operator:
  cluster:
    name: "dev-cluster"
```

### Production with Cilium
```yaml
auth:
  token: "prod-token"

operator:
  cluster:
    name: "prod-cluster"
  cilium:
    disableFlows: false
  safeApply:
    enabled: true

resources:
  limits:
    cpu: 500m
    memory: 2Gi
  requests:
    cpu: 250m
    memory: 1Gi

nodeSelector:
  node-role.kubernetes.io/worker: "true"
```

### Production with Istio
```yaml
auth:
  token: "prod-token"

operator:
  cluster:
    name: "prod-cluster"
  cilium:
    disableFlows: true
  istio:
    enabled: true
    alsPort: 8080
  safeApply:
    enabled: true

resources:
  limits:
    cpu: 1000m
    memory: 4Gi
  requests:
    cpu: 500m
    memory: 2Gi
```

## Configuration Best Practices

### Resource Allocation
1. Start with default resources and monitor usage
2. Increase limits for clusters with >100 pods
3. Consider node resources when setting requests

### Security
1. Always use TLS for server connections
2. Enable safe-apply only after testing
3. Use service account annotations for cloud IAM
4. Apply network policies in production

### High Availability
1. Monitor operator health via dashboard
2. Set appropriate liveness probe values
3. Use pod anti-affinity for future multi-replica mode
4. Configure resource requests to ensure scheduling

## Validating Configuration

Before deploying, validate your values file:

```bash
helm lint . -f values.yaml
```

Test the deployment without installing:

```bash
helm install kestrel-operator \
  oci://ghcr.io/kestrelai/charts/kestrel-operator \
  --dry-run --debug \
  -f values.yaml
```

## Updating Configuration

To update operator configuration:

1. Modify your values file
2. Apply the changes:
```bash
helm upgrade kestrel-operator \
  oci://ghcr.io/kestrelai/charts/kestrel-operator \
  --namespace kestrel-ai \
  -f values.yaml
```

3. Verify the rollout:
```bash
kubectl rollout status deployment/kestrel-operator -n kestrel-ai
```

## Next Steps

- [Troubleshoot configuration issues](/operator/troubleshooting)
- [Monitor operator performance](/operator/monitoring)
- [Configure namespace permissions](/permissions/namespaces)